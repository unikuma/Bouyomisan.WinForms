# 棒読みさん WinForms版
棒読みさんはAquesTalkPlayerを使用し、音声と字幕を自動生成する為のツールです。  
[mikado394mさんが開発しているゆくサク](https://github.com/mikado394m/yukkuriutil1)のような機能を持ち、それに加え発音のテストやwaveのみの出力などの追加機能も実装しています。

![棒読みさん メイン画面](./images/棒読みさんメイン画面.png)

# 目次
- [導入方法](#導入方法)
    - [1. AquesTalkPlayerのダウンロード](#1-aquestalkplayerのダウンロード)
    - [2. 棒読みさんのダウンロード](#2-棒読みさんのダウンロード)
- [使い方](#使い方)
    - [メイン画面の使い方](#メイン画面の使い方)
    - [ツールバーの使い方](#ツールバーの使い方)
    - [キャラクター設定の編集 追加 削除](#キャラクター設定の編集-追加-削除)
        - [キャラクター設定の各種項目](#キャラクター設定の各種項目)
    - [プリセットの編集 追加 削除](#プリセットの編集-追加-削除)
        - [プリセットの各種項目](#プリセットの各種項目)
- [バグ 不具合 質問等](#バグ-不具合-質問等)
- [使用した言語 ツール ライブラリ等](#使用した言語-ツール-ライブラリ等)

# 導入方法
## 1. AquesTalkPlayerのダウンロード
株式会社アクエストさんのホームページより AquesTalkPlayerをダウンロードし、ダウンロードしたzipファイルを解凍します。  
https://www.a-quest.com/products/aquestalkplayer.html#download

## 2. 棒読みさんのダウンロード
[Releaseページ](https://github.com/unikuma/Bouyomisan.WinForms/releases)から最新版の棒読みさんをダウンロードし、zipファイルを解凍します。  
解凍が終わったら「bymsnwf.exe」があるフォルダに[手順1](#1-aquestalkplayerのダウンロード)で解凍した「aquestalkplayer」フォルダをコピーします。

![フォルダごとコピー](./images/フォルダごとコピー.png)  
これにて導入は終了になります。

# 使い方
「字幕」テキストボックスに読み上げたいテキストを入力し、「この領域をAviUtlにD&D」と書いている場所を左クリックし続ける事で音声生成及び字幕生成を開始します。  
そのうち色が緑になりメッセージが 「**生成が完了しました。AviUtl上でマウスを放してください**」 と切り替わったら拡張編集にドロップすることで操作が完了します。  
![ファイル生成完了後](./images/ファイル生成完了後.png)

発音を修正する場合は下の「発音」テキストボックスの内容を修正する事により字幕は変えずに音声のみ正しく発音することが出来ます。  
![発音の変更](./images/発音の変更.png)

## メイン画面の使い方
- **ツールバー**  
    [ツールバーの使い方](#ツールバーの使い方)を参照。
- **字幕**  
    exoファイルを作成する時に使われます。
- **発音**  
    wavファイルを作成する時に使われます。またアクセント記号を設定する事が出来ます。  
    なお選択中のキャラクターで「棒読みにする」が**無効**の場合は**アクセント記号が無視されます。**  
    例: `#>カブ_シキガ'イシャ/アクエ'_スト。`[公式サイトより引用](https://www.a-quest.com/products/aquestalkplayer_man.html#a-index8)
- **字幕をコピー**  
    この項目が有効の場合、「字幕」テキストボックスの内容を「発音」テキストボックスにそのままコピーします。  
    デフォルトでこの項目は有効ですが、「発音」テキストボックスが選択されると項目が無効になります。
- **「この領域をAviUtlにD&D」**  
    この領域をクリックし続ける事により音声生成及び字幕生成を開始します。  
    この領域が黄色だと音声生成or字幕生成中、緑だとドロップ可能を表します。
- **設定選択用コンボボックス**  
    上に配置されているコンボボックスがキャラクター選択用です。  
    右下に配置されているコンボボックスがプリセット選択用です。
- **waveのみ出力**  
    wavファイルのみを作成しドラッグを開始するための項目です。この項目が有効の場合、exoファイルは生成されません。

## ツールバーの使い方
- **発音の再生**  
    「発音」テキストボックスの内容を読み上げます。F5キーを押すことでも再生する事が可能です。
- **設定**  
    キャラクターやプリセットの設定を行うウィンドウを表示します。  
    キャラクターの設定方法は[こちら](#キャラクター設定の編集-追加-削除)  
    プリセットの設定方法は[こちら](#プリセットの編集-追加-削除)
- **ウィンドウをピン留め**  
    ウィンドウを最前面で固定することができます。画像が青色になっていれば機能が有効です。
- **音声出力先表示**  
    現在選択中のプリセットの音声出力先をエクスプローラで開きます。設定されている出力先が存在しない場合は新しく作ります。
- **ハテナ**  
    棒読みさん WinForms版のバージョン情報を表示します。

## キャラクター設定の編集 追加 削除
設定ウィンドウを開き、キャラクタータブ左側のリストボックスを右クリックすると設定の追加及び削除を行うことができます。  
**※なおメイン画面で選択中の設定を削除する事は出来ません**  
![キャラクタータブ](./images/キャラクタータブ.png)

### キャラクター設定の各種項目
- **名前**  
    キャラクター設定の名前を入力します。
- **声種**  
    キャラクターの声種を選択します。AquesTalk1とAquesTalk2の声種に対応しています。
- **音量・速度・音程**  
    言わずもがな。
- **再生後の余韻(ms)**  
    音声再生後の余韻を-10000~10000ミリ秒の間で指定します。exoの生成に使う為「waveのみ出力」を有効にした状態では効果ありません。
- **棒読みにする**  
    この項目が有効の場合、アクセント記号が無視されアクセントが平板型になります。  
    発音にアクセント記号を入れたのに読み方が変わらない...みたいな時はここを疑ってみると良いかもしれません。
- **Exoテンプレート**  
    字幕用のexoテンプレートです。TODO: 作り方を書く

## プリセットの編集 追加 削除
設定ウィンドウを開き、プリセットタブ左側のリストボックスを右クリックすると設定の追加及び削除を行うことができます。  
**※なおメイン画面で選択中の設定を削除する事は出来ません**  
![プリセットタブ](./images/プリセットタブ.png)

### プリセットの各種項目
- **名前**  
    プリセットの名前を入力します。
- **音声出力先**  
    wav・exo・txtファイルを保存するフォルダを設定します。
- **AviUtlのFPS**  
    AviUtlのプロジェクトで設定しているFPS値を設定します。この値が食い違っていると思わぬ挙動が発生する可能性があります。  
    例えば、AviUtlのプロジェクトで設定したFPSが60なのにプリセットで設定したFPSが30だとドロップした字幕や音声が短くなったり...その逆も。

# バグ 不具合 質問等
[作者Twitter](https://twitter.com/unikuma_sub)のリプライやDM、GitHubのIssueによろしくお願いします。

# 使用した言語 ツール ライブラリ等
- C# (.NET6 & WinForms)
- Microsoft Visual Studio Community 2022
- NAudio https://github.com/naudio/NAudio  
    Copyright &copy; 2020 Mark Heath  
    MIT License
- Extension.Serialization  
    Copyright &copy; 2023- unikuma
